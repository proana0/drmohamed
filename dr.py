from requests import get as g , post as p

from urllib.parse import quote_plus as ue

from time import sleep as s


def login(num,pas):
	url = "https://mobile.vodafone.com.eg/services/security/oauth/oauth/token"
	
	hd = {"Accept": "application/json, text/plain, */*",
"api-host": "token",
"Connection": "keep-alive",
"Content-Type": "application/x-www-form-urlencoded",
"Content-Length": "100",
"Host": "mobile.vodafone.com.eg",
"User-Agent": "okhttp/3.12.1"}
	
	dt = "username="+num+"&password="+ue(pas)+"&client_secret=secret&grant_type=password&client_id=my-trusted-client"
	
	try:
		res = p(url,headers=hd,data=dt).json()
	except:
		res = p(url,headers=hd,data=dt).json()
	
	try:
		tok = res["access_token"]
		return tok
	except:
		exit("Error number or password")


def delete(token):
	url = "https://mobile.vodafone.com.eg/services/dxl/pom/productOrder"
	
	hd = {"Host":"mobile.vodafone.com.eg",'msisdn':num,
  'access-token':token,
  'Connection':'Keep-Alive',
  'User-Agent':'Mozilla/5.0 (Linux; Android 8.1.0; DRA-LX2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Mobile Safari/537.36',
  'Content-Type':'application/json',
  'Accept':'application/json'}
	
	dt = '{"channel":{"name":"MobileApp"},"orderItem":[{"action":"delete","product":{"characteristic":[{"name":"ExecutionType","value":"Sync"},{"name":"LangId","value":"en"}],"relatedParty":[{"id":"'+num+'","name":"MSISDN","role":"Subscriber"}],"id":"120","@type":"MI"}}],"@type":"MIProfile"}'
	
	try:
		snd = p(url,headers=hd,data=dt).json()["state"]
	except:
		snd = p(url,headers=hd,data=dt).json()["state"]
	
	if(snd=="Completed"):
		return True
	else:
		return False
	


def sub(token):
	url = "https://mobile.vodafone.com.eg/services/dxl/pom/productOrder"
	
	hd = {"Host":"mobile.vodafone.com.eg",'msisdn':num,
  'access-token':token,
  'Connection':'Keep-Alive',
  'User-Agent':'Mozilla/5.0 (Linux; Android 8.1.0; DRA-LX2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Mobile Safari/537.36',
  'Content-Type':'application/json',
  'Accept':'application/json'}
	
	dt = '{"channel":{"name":"MobileApp"},"orderItem":[{"action":"add","product":{"characteristic":[{"name":"ExecutionType","value":"Sync"},{"name":"LangId","value":"en"}],"relatedParty":[{"id":"'+num+'","name":"MSISDN","role":"Subscriber"}],"id":"120","@type":"MI"}}],"@type":"MIProfile"}'
	
	try:
		snd = p(url,headers=hd,data=dt).json()["state"]
	except:
		snd = p(url,headers=hd,data=dt).json()["state"]
	
	if(snd=="Completed"):
		return True
	else:
		return False

e = 0
def add(token):
	global e
	c1 = delete(token)
	c2 = sub(token)
	if(e>=3):
		exit("Try again later")
	if(c1 == True and c2 == True):
		print("\n"+"-"*40+"\n\n\tAdded 1GB\n\n"+"-"*40)
	else:
		e += 1
		print("Can't Add megabytes now !")
		



num = input("Enter Number:")

pas =input("Enter Password: ")

tok = login(num,pas)


mnts = int(input("Renew After [ ... ] Minutes -: "))

while True :
	add(tok)
	s(mnts*60)